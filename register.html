<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grow smart - Farmer Registration</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 450px;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(to right, #2e7d32, #4caf50);
            color: white;
            padding: 25px 20px;
            text-align: center;
            position: relative;
        }
        
        .app-name {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .app-subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .language-selection {
            padding: 30px 20px;
            text-align: center;
        }
        
        .language-title {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: #333;
        }
        
        .language-options {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .language-btn {
            background: none;
            border: 2px solid #4caf50;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
            color: #2e7d32;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            width: 120px;
        }
        
        .language-btn i {
            font-size: 1.5rem;
            margin-bottom: 8px;
        }
        
        .language-btn:hover {
            background-color: rgba(76, 175, 80, 0.1);
        }
        
        .language-btn.active {
            background-color: #2e7d32;
            color: white;
            border-color: #2e7d32;
        }
        
        .permission-note {
            background-color: #e8f5e9;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 0.9rem;
            color: #2e7d32;
            text-align: left;
        }
        
        .permission-note i {
            margin-right: 8px;
        }
        
        .form-container {
            padding: 25px 20px;
            display: none;
        }
        
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #4caf50;
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }
        
        .input-error {
            border-color: #e74c3c;
        }
        
        .input-success {
            border-color: #2ecc71;
        }
        
        .error-message {
            display: none;
            align-items: center;
            color: #e74c3c;
            font-size: 0.85rem;
            margin-top: 5px;
        }
        
        .error-message i {
            margin-right: 5px;
        }
        
        .password-container {
            position: relative;
        }
        
        .password-toggle {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #777;
            cursor: pointer;
            font-size: 1rem;
        }
        
        .password-strength {
            margin-top: 10px;
        }
        
        .strength-bar {
            height: 5px;
            background-color: #eee;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 5px;
        }
        
        .strength-fill {
            height: 100%;
            width: 0%;
            transition: all 0.3s ease;
        }
        
        .strength-text {
            font-size: 0.8rem;
            color: #777;
        }
        
        .checkbox-group {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
        }
        
        .checkbox-group input {
            margin-right: 10px;
            margin-top: 3px;
        }
        
        .checkbox-group label {
            font-size: 0.9rem;
            color: #555;
        }
        
        .checkbox-group a {
            color: #2e7d32;
            text-decoration: none;
        }
        
        .checkbox-group a:hover {
            text-decoration: underline;
        }
        
        .submit-btn {
            background: linear-gradient(to right, #2e7d32, #4caf50);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 15px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 125, 50, 0.3);
        }
        
        .submit-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .loader {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .success-message {
            display: none;
            background-color: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .success-message i {
            margin-right: 8px;
        }
        
        .error-alert {
            display: none;
            background-color: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .error-alert i {
            margin-right: 8px;
        }
        
        .login-link {
            text-align: center;
            margin-top: 20px;
            font-size: 0.9rem;
            color: #555;
        }
        
        .login-link a {
            color: #2e7d32;
            text-decoration: none;
            font-weight: 500;
        }
        
        .login-link a:hover {
            text-decoration: underline;
        }
        
        .back-btn {
            background: none;
            border: 1px solid #2e7d32;
            color: #2e7d32;
            border-radius: 10px;
            padding: 10px 15px;
            font-size: 0.9rem;
            cursor: pointer;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .back-btn i {
            margin-right: 8px;
        }
        
        .back-btn:hover {
            background-color: rgba(46, 125, 50, 0.1);
        }
        
        .speech-indicator {
            position: absolute;
            right: 40px;
            top: 50%;
            transform: translateY(-50%);
            color: #4caf50;
            font-size: 1rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .speaking .speech-indicator {
            opacity: 1;
        }
        
        .section-title {
            font-size: 1.1rem;
            color: #2e7d32;
            margin: 25px 0 15px 0;
            padding-bottom: 8px;
            border-bottom: 1px solid #e8f5e9;
        }
        
        /* CAPTCHA Styles */
        .captcha-container {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .captcha-display {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            gap: 10px;
        }
        
        .captcha-text {
            font-family: 'Courier New', monospace;
            font-size: 1.5rem;
            font-weight: bold;
            letter-spacing: 3px;
            background: linear-gradient(45deg, #2e7d32, #4caf50);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            padding: 10px;
            border-radius: 5px;
            border: 1px dashed #4caf50;
            user-select: none;
        }
        
        .captcha-refresh {
            background: none;
            border: none;
            color: #4caf50;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .captcha-refresh:hover {
            transform: rotate(90deg);
            color: #2e7d32;
        }
        
        .captcha-input-container {
            display: flex;
            gap: 10px;
        }
        
        .captcha-input {
            flex: 1;
        }
        
        .captcha-error {
            display: none;
            align-items: center;
            color: #e74c3c;
            font-size: 0.85rem;
            margin-top: 5px;
            text-align: center;
        }
        
        .captcha-error i {
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="app-name">Grow smart</div>
            <div class="app-subtitle">Smart Agricultural Assistant</div>
        </div>
        
        <!-- Language Selection Section -->
        <div id="languageSection" class="language-selection">
            <h2 class="language-title">Choose Your Language</h2>
            <div class="language-options">
                <button id="englishBtn" class="language-btn">
                    <i class="fas fa-language"></i>
                    English
                </button>
                <button id="hindiBtn" class="language-btn">
                    <i class="fas fa-language"></i>
                    हिन्दी
                </button>
            </div>
            
            <div class="permission-note">
                <i class="fas fa-info-circle"></i>
                <strong>Note:</strong> This app uses text-to-speech to assist with form filling. 
                When you click on any input field, instructions will be spoken in Hindi if selected.
            </div>
        </div>
        
        <!-- Registration Form Section -->
        <div id="formSection" class="form-container">
            <button id="backBtn" class="back-btn">
                <i class="fas fa-arrow-left"></i>
                Change Language
            </button>
            
            <div id="errorAlert" class="error-alert">
                <i class="fas fa-exclamation-circle"></i>
                <span id="errorAlertText">Error occurred</span>
            </div>
            
            <div id="successMessage" class="success-message">
                <i class="fas fa-check-circle"></i>
                <span>Registration successful! Redirecting to login...</span>
            </div>
            
            <form id="registerForm">
                <h3 class="section-title" id="personalInfoTitle">Personal Information</h3>
                
                <div class="form-group">
                    <label for="fullName" class="form-label" id="nameLabel">Full Name</label>
                    <div class="password-container">
                        <input type="text" id="fullName" class="form-input" placeholder="Enter your full name">
                        <div class="speech-indicator">
                            <i class="fas fa-volume-up"></i>
                        </div>
                    </div>
                    <div id="nameError" class="error-message">
                        <i class="fas fa-exclamation-circle"></i>
                        <span>Please enter your full name</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="phoneNumber" class="form-label" id="phoneLabel">Phone Number</label>
                    <div class="password-container">
                        <input type="tel" id="phoneNumber" class="form-input" placeholder="Enter your phone number">
                        <div class="speech-indicator">
                            <i class="fas fa-volume-up"></i>
                        </div>
                    </div>
                    <div id="phoneError" class="error-message">
                        <i class="fas fa-exclamation-circle"></i>
                        <span>Please enter a valid phone number</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="registerEmail" class="form-label" id="emailLabel">Email Address</label>
                    <div class="password-container">
                        <input type="email" id="registerEmail" class="form-input" placeholder="Enter your email">
                        <div class="speech-indicator">
                            <i class="fas fa-volume-up"></i>
                        </div>
                    </div>
                    <div id="emailError" class="error-message">
                        <i class="fas fa-exclamation-circle"></i>
                        <span>Please enter a valid email address</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="registerPassword" class="form-label" id="passwordLabel">Password</label>
                    <div class="password-container">
                        <input type="password" id="registerPassword" class="form-input" placeholder="Create a password">
                        <div class="speech-indicator">
                            <i class="fas fa-volume-up"></i>
                        </div>
                        <button type="button" id="registerPasswordToggle" class="password-toggle">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <div id="passwordError" class="error-message">
                        <i class="fas fa-exclamation-circle"></i>
                        <span>Password must be at least 8 characters with uppercase, lowercase, number and special character</span>
                    </div>
                    
                    <div class="password-strength">
                        <div class="strength-bar">
                            <div id="passwordStrengthBar" class="strength-fill"></div>
                        </div>
                        <div id="passwordStrengthText" class="strength-text" style="display: none;">
                            Password strength: <span id="strengthText">Weak</span>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="confirmPassword" class="form-label" id="confirmPasswordLabel">Confirm Password</label>
                    <div class="password-container">
                        <input type="password" id="confirmPassword" class="form-input" placeholder="Confirm your password">
                        <div class="speech-indicator">
                            <i class="fas fa-volume-up"></i>
                        </div>
                        <button type="button" id="confirmPasswordToggle" class="password-toggle">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <div id="confirmPasswordError" class="error-message">
                        <i class="fas fa-exclamation-circle"></i>
                        <span>Passwords do not match</span>
                    </div>
                </div>
                
                <h3 class="section-title" id="bankInfoTitle">Bank Account Details (Optional)</h3>
                
                <div class="form-group">
                    <label for="accountHolderName" class="form-label" id="accountHolderLabel">Account Holder Name</label>
                    <div class="password-container">
                        <input type="text" id="accountHolderName" class="form-input" placeholder="Enter account holder name">
                        <div class="speech-indicator">
                            <i class="fas fa-volume-up"></i>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="accountNumber" class="form-label" id="accountNumberLabel">Account Number</label>
                    <div class="password-container">
                        <input type="text" id="accountNumber" class="form-input" placeholder="Enter account number">
                        <div class="speech-indicator">
                            <i class="fas fa-volume-up"></i>
                        </div>
                    </div>
                    <div id="accountNumberError" class="error-message">
                        <i class="fas fa-exclamation-circle"></i>
                        <span>Please enter a valid account number</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="ifscCode" class="form-label" id="ifscLabel">IFSC Code</label>
                    <div class="password-container">
                        <input type="text" id="ifscCode" class="form-input" placeholder="Enter IFSC code">
                        <div class="speech-indicator">
                            <i class="fas fa-volume-up"></i>
                        </div>
                    </div>
                    <div id="ifscError" class="error-message">
                        <i class="fas fa-exclamation-circle"></i>
                        <span>Please enter a valid IFSC code</span>
                    </div>
                </div>
                
                <!-- CAPTCHA Section -->
                <div class="form-group">
                    <div class="captcha-container">
                        <label class="form-label" id="captchaLabel">Enter CAPTCHA Code</label>
                        <div class="captcha-display">
                            <div id="captchaText" class="captcha-text">ABCD12</div>
                            <button type="button" id="captchaRefresh" class="captcha-refresh" title="Refresh CAPTCHA">
                                <i class="fas fa-redo"></i>
                            </button>
                        </div>
                        <div class="captcha-input-container">
                            <input type="text" id="captchaInput" class="form-input captcha-input" placeholder="Enter the code above">
                        </div>
                        <div id="captchaError" class="captcha-error">
                            <i class="fas fa-exclamation-circle"></i>
                            <span>Please enter the correct CAPTCHA code</span>
                        </div>
                    </div>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="termsAgree">
                    <label for="termsAgree" id="termsLabel">I agree to the <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a></label>
                </div>
                
                <button type="submit" id="registerButton" class="submit-btn">
                    <div id="registerLoader" class="loader"></div>
                    <span id="registerText">Create Account</span>
                </button>
            </form>
            
            <div class="login-link">
                <span id="loginText">Already have an account?</span> <a href="login.html" id="loginLink">Sign In</a>
            </div>
        </div>
    </div>

    <script>
        // ==============================================
        // MAIN REGISTRATION PAGE - COMPLETE SOLUTION
        // ==============================================
        
        // Global variables
        let currentLanguage = 'English';
        let speechEnabled = false;
        let currentCaptcha = '';
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log("Registration page initialized");
            
            // ==============================================
            // 1. ELEMENT REFERENCES
            // ==============================================
            const elements = {
                languageSection: document.getElementById('languageSection'),
                formSection: document.getElementById('formSection'),
                englishBtn: document.getElementById('englishBtn'),
                hindiBtn: document.getElementById('hindiBtn'),
                backBtn: document.getElementById('backBtn'),
                registerForm: document.getElementById('registerForm'),
                fullName: document.getElementById('fullName'),
                phoneNumber: document.getElementById('phoneNumber'),
                registerEmail: document.getElementById('registerEmail'),
                registerPassword: document.getElementById('registerPassword'),
                confirmPassword: document.getElementById('confirmPassword'),
                accountHolderName: document.getElementById('accountHolderName'),
                accountNumber: document.getElementById('accountNumber'),
                ifscCode: document.getElementById('ifscCode'),
                termsAgree: document.getElementById('termsAgree'),
                registerButton: document.getElementById('registerButton'),
                registerLoader: document.getElementById('registerLoader'),
                registerText: document.getElementById('registerText'),
                successMessage: document.getElementById('successMessage'),
                errorAlert: document.getElementById('errorAlert'),
                captchaText: document.getElementById('captchaText'),
                captchaInput: document.getElementById('captchaInput'),
                captchaRefresh: document.getElementById('captchaRefresh'),
                passwordStrengthBar: document.getElementById('passwordStrengthBar'),
                passwordStrengthText: document.getElementById('passwordStrengthText'),
                strengthText: document.getElementById('strengthText')
            };
            
            // ==============================================
            // 2. INITIALIZATION
            // ==============================================
            function initializePage() {
                console.log("Initializing page...");
                
                // Hide error alert by default
                if (elements.errorAlert) {
                    elements.errorAlert.style.display = 'none';
                }
                
                // Generate initial CAPTCHA
                generateCaptcha();
                
                // Setup event listeners
                setupEventListeners();
                
                console.log("Page initialization complete");
            }
            
            // ==============================================
            // 3. EVENT LISTENER SETUP
            // ==============================================
            function setupEventListeners() {
                // Language selection
                if (elements.englishBtn) {
                    elements.englishBtn.addEventListener('click', function() {
                        console.log("English selected");
                        selectLanguage('English');
                    });
                }
                
                if (elements.hindiBtn) {
                    elements.hindiBtn.addEventListener('click', function() {
                        console.log("Hindi selected");
                        selectLanguage('Hindi');
                    });
                }
                
                // Back button
                if (elements.backBtn) {
                    elements.backBtn.addEventListener('click', function() {
                        elements.formSection.style.display = 'none';
                        elements.languageSection.style.display = 'block';
                    });
                }
                
                // Password toggles
                const registerPasswordToggle = document.getElementById('registerPasswordToggle');
                const confirmPasswordToggle = document.getElementById('confirmPasswordToggle');
                
                if (registerPasswordToggle) {
                    registerPasswordToggle.addEventListener('click', function() {
                        togglePasswordVisibility(elements.registerPassword, this);
                    });
                }
                
                if (confirmPasswordToggle) {
                    confirmPasswordToggle.addEventListener('click', function() {
                        togglePasswordVisibility(elements.confirmPassword, this);
                    });
                }
                
                // CAPTCHA refresh
                if (elements.captchaRefresh) {
                    elements.captchaRefresh.addEventListener('click', function() {
                        generateCaptcha();
                    });
                }
                
                // Form submission
                if (elements.registerForm) {
                    elements.registerForm.addEventListener('submit', handleFormSubmit);
                }
                
                // Real-time validation
                if (elements.fullName) elements.fullName.addEventListener('blur', validateFullName);
                if (elements.phoneNumber) elements.phoneNumber.addEventListener('blur', validatePhone);
                if (elements.registerEmail) elements.registerEmail.addEventListener('blur', validateEmail);
                if (elements.registerPassword) {
                    elements.registerPassword.addEventListener('input', validatePassword);
                    elements.registerPassword.addEventListener('input', updatePasswordStrength);
                }
                if (elements.confirmPassword) elements.confirmPassword.addEventListener('blur', validateConfirmPassword);
                if (elements.accountNumber) elements.accountNumber.addEventListener('blur', validateAccountNumber);
                if (elements.ifscCode) elements.ifscCode.addEventListener('blur', validateIfsc);
                if (elements.captchaInput) elements.captchaInput.addEventListener('blur', validateCaptcha);
                
                // Speech support for input fields
                setupSpeechSupport();
            }
            
            // ==============================================
            // 4. LANGUAGE SELECTION FUNCTIONS
            // ==============================================
            function selectLanguage(lang) {
                console.log(`Selecting language: ${lang}`);
                
                // Update global variables
                currentLanguage = lang;
                speechEnabled = lang === 'Hindi';
                
                // Update active button
                updateActiveButton(lang);
                
                // Update form text
                updateFormLanguage(lang);
                
                // Switch to form section
                showFormSection();
                
                // Initialize speech synthesis
                if (speechEnabled && window.speechSynthesis) {
                    window.speechSynthesis.resume();
                }
            }
            
            function updateActiveButton(lang) {
                if (elements.englishBtn) {
                    elements.englishBtn.classList.remove('active');
                }
                if (elements.hindiBtn) {
                    elements.hindiBtn.classList.remove('active');
                }
                
                if (lang === 'English' && elements.englishBtn) {
                    elements.englishBtn.classList.add('active');
                } else if (lang === 'Hindi' && elements.hindiBtn) {
                    elements.hindiBtn.classList.add('active');
                }
            }
            
            function showFormSection() {
                if (elements.languageSection) {
                    elements.languageSection.style.display = 'none';
                }
                if (elements.formSection) {
                    elements.formSection.style.display = 'block';
                }
            }
            
            function updateFormLanguage(lang) {
                const translations = {
                    English: {
                        personalInfoTitle: "Personal Information",
                        bankInfoTitle: "Bank Account Details (Optional)",
                        nameLabel: "Full Name",
                        phoneLabel: "Phone Number",
                        emailLabel: "Email Address",
                        passwordLabel: "Password",
                        confirmPasswordLabel: "Confirm Password",
                        accountHolderLabel: "Account Holder Name",
                        accountNumberLabel: "Account Number",
                        ifscLabel: "IFSC Code",
                        captchaLabel: "Enter CAPTCHA Code",
                        termsLabel: 'I agree to the <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a>',
                        loginText: "Already have an account?",
                        loginLink: "Sign In",
                        registerText: "Create Account",
                        placeholders: {
                            fullName: "Enter your full name",
                            phoneNumber: "Enter your phone number",
                            registerEmail: "Enter your email",
                            registerPassword: "Create a password",
                            confirmPassword: "Confirm your password",
                            accountHolderName: "Enter account holder name",
                            accountNumber: "Enter account number",
                            ifscCode: "Enter IFSC code",
                            captchaInput: "Enter the code above"
                        }
                    },
                    Hindi: {
                        personalInfoTitle: "व्यक्तिगत जानकारी",
                        bankInfoTitle: "बैंक खाता विवरण (वैकल्पिक)",
                        nameLabel: "पूरा नाम",
                        phoneLabel: "फोन नंबर",
                        emailLabel: "ईमेल पता",
                        passwordLabel: "पासवर्ड",
                        confirmPasswordLabel: "पासवर्ड की पुष्टि करें",
                        accountHolderLabel: "खाता धारक का नाम",
                        accountNumberLabel: "खाता संख्या",
                        ifscLabel: "आईएफएससी कोड",
                        captchaLabel: "कैप्चा कोड दर्ज करें",
                        termsLabel: 'मैं <a href="#">सेवा की शर्तें</a> और <a href="#">गोपनीयता नीति</a> से सहमत हूं',
                        loginText: "पहले से ही एक खाता है?",
                        loginLink: "साइन इन करें",
                        registerText: "खाता बनाएं",
                        placeholders: {
                            fullName: "अपना पूरा नाम दर्ज करें",
                            phoneNumber: "अपना फोन नंबर दर्ज करें",
                            registerEmail: "अपना ईमेल दर्ज करें",
                            registerPassword: "पासवर्ड बनाएं",
                            confirmPassword: "अपने पासवर्ड की पुष्टि करें",
                            accountHolderName: "खाता धारक का नाम दर्ज करें",
                            accountNumber: "खाता संख्या दर्ज करें",
                            ifscCode: "आईएफएससी कोड दर्ज करें",
                            captchaInput: "ऊपर दिया गया कोड दर्ज करें"
                        }
                    }
                };
                
                const translation = translations[lang];
                
                // Update titles
                document.getElementById('personalInfoTitle').textContent = translation.personalInfoTitle;
                document.getElementById('bankInfoTitle').textContent = translation.bankInfoTitle;
                
                // Update labels
                document.getElementById('nameLabel').textContent = translation.nameLabel;
                document.getElementById('phoneLabel').textContent = translation.phoneLabel;
                document.getElementById('emailLabel').textContent = translation.emailLabel;
                document.getElementById('passwordLabel').textContent = translation.passwordLabel;
                document.getElementById('confirmPasswordLabel').textContent = translation.confirmPasswordLabel;
                document.getElementById('accountHolderLabel').textContent = translation.accountHolderLabel;
                document.getElementById('accountNumberLabel').textContent = translation.accountNumberLabel;
                document.getElementById('ifscLabel').textContent = translation.ifscLabel;
                document.getElementById('captchaLabel').textContent = translation.captchaLabel;
                document.getElementById('termsLabel').innerHTML = translation.termsLabel;
                document.getElementById('loginText').textContent = translation.loginText;
                document.getElementById('loginLink').textContent = translation.loginLink;
                document.getElementById('registerText').textContent = translation.registerText;
                
                // Update placeholders
                if (elements.fullName) elements.fullName.placeholder = translation.placeholders.fullName;
                if (elements.phoneNumber) elements.phoneNumber.placeholder = translation.placeholders.phoneNumber;
                if (elements.registerEmail) elements.registerEmail.placeholder = translation.placeholders.registerEmail;
                if (elements.registerPassword) elements.registerPassword.placeholder = translation.placeholders.registerPassword;
                if (elements.confirmPassword) elements.confirmPassword.placeholder = translation.placeholders.confirmPassword;
                if (elements.accountHolderName) elements.accountHolderName.placeholder = translation.placeholders.accountHolderName;
                if (elements.accountNumber) elements.accountNumber.placeholder = translation.placeholders.accountNumber;
                if (elements.ifscCode) elements.ifscCode.placeholder = translation.placeholders.ifscCode;
                if (elements.captchaInput) elements.captchaInput.placeholder = translation.placeholders.captchaInput;
            }
            
            // ==============================================
            // 5. FORM VALIDATION FUNCTIONS
            // ==============================================
            const patterns = {
                email: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
                phone: /^[6-9]\d{9}$/,
                password: /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/,
                ifsc: /^[A-Z]{4}0[A-Z0-9]{6}$/
            };
            
            function validateFullName() {
                const name = elements.fullName.value.trim();
                const errorElement = document.getElementById('nameError');
                
                if (!name) {
                    showError(elements.fullName, errorElement, currentLanguage === 'Hindi' ? 'कृपया अपना पूरा नाम दर्ज करें' : 'Please enter your full name');
                    return false;
                }
                
                if (name.length < 2) {
                    showError(elements.fullName, errorElement, currentLanguage === 'Hindi' ? 'नाम कम से कम 2 वर्णों का होना चाहिए' : 'Name must be at least 2 characters long');
                    return false;
                }
                
                showSuccess(elements.fullName, errorElement);
                return true;
            }
            
            function validatePhone() {
                const phone = elements.phoneNumber.value.trim();
                const digitsOnly = phone.replace(/\D/g, '');
                const errorElement = document.getElementById('phoneError');
                
                if (!phone) {
                    showError(elements.phoneNumber, errorElement, currentLanguage === 'Hindi' ? 'कृपया अपना फोन नंबर दर्ज करें' : 'Please enter your phone number');
                    return false;
                }
                
                if (!patterns.phone.test(digitsOnly)) {
                    showError(elements.phoneNumber, errorElement, currentLanguage === 'Hindi' ? 'कृपया एक वैध 10-अंकीय फोन नंबर दर्ज करें' : 'Please enter a valid 10-digit phone number');
                    return false;
                }
                
                showSuccess(elements.phoneNumber, errorElement);
                return true;
            }
            
            function validateEmail() {
                const email = elements.registerEmail.value.trim();
                const errorElement = document.getElementById('emailError');
                
                if (!email) {
                    showError(elements.registerEmail, errorElement, currentLanguage === 'Hindi' ? 'कृपया अपना ईमेल पता दर्ज करें' : 'Please enter your email address');
                    return false;
                }
                
                if (!patterns.email.test(email)) {
                    showError(elements.registerEmail, errorElement, currentLanguage === 'Hindi' ? 'कृपया एक वैध ईमेल पता दर्ज करें' : 'Please enter a valid email address');
                    return false;
                }
                
                showSuccess(elements.registerEmail, errorElement);
                return true;
            }
            
            function validatePassword() {
                const password = elements.registerPassword.value;
                const errorElement = document.getElementById('passwordError');
                
                if (!password) {
                    showError(elements.registerPassword, errorElement, currentLanguage === 'Hindi' ? 'कृपया पासवर्ड दर्ज करें' : 'Please enter a password');
                    return false;
                }
                
                if (!patterns.password.test(password)) {
                    showError(elements.registerPassword, errorElement, currentLanguage === 'Hindi' ? 'पासवर्ड कम से कम 8 वर्णों का होना चाहिए, जिसमें बड़े और छोटे अक्षर, संख्या और विशेष वर्ण शामिल हों' : 'Password must be at least 8 characters with uppercase, lowercase, number and special character');
                    return false;
                }
                
                showSuccess(elements.registerPassword, errorElement);
                return true;
            }
            
            function validateConfirmPassword() {
                const password = elements.registerPassword.value;
                const confirmPassword = elements.confirmPassword.value;
                const errorElement = document.getElementById('confirmPasswordError');
                
                if (!confirmPassword) {
                    showError(elements.confirmPassword, errorElement, currentLanguage === 'Hindi' ? 'कृपया पासवर्ड की पुष्टि करें' : 'Please confirm your password');
                    return false;
                }
                
                if (password !== confirmPassword) {
                    showError(elements.confirmPassword, errorElement, currentLanguage === 'Hindi' ? 'पासवर्ड मेल नहीं खाते' : 'Passwords do not match');
                    return false;
                }
                
                showSuccess(elements.confirmPassword, errorElement);
                return true;
            }
            
            function validateAccountNumber() {
                const accountNumber = elements.accountNumber.value.trim();
                const errorElement = document.getElementById('accountNumberError');
                
                // Optional field
                if (!accountNumber) {
                    hideError(elements.accountNumber, errorElement);
                    return true;
                }
                
                if (accountNumber.length < 9) {
                    showError(elements.accountNumber, errorElement, currentLanguage === 'Hindi' ? 'कृपया एक वैध खाता संख्या दर्ज करें' : 'Please enter a valid account number');
                    return false;
                }
                
                showSuccess(elements.accountNumber, errorElement);
                return true;
            }
            
            function validateIfsc() {
                const ifsc = elements.ifscCode.value.trim().toUpperCase();
                const errorElement = document.getElementById('ifscError');
                
                // Optional field
                if (!ifsc) {
                    hideError(elements.ifscCode, errorElement);
                    return true;
                }
                
                if (!patterns.ifsc.test(ifsc)) {
                    showError(elements.ifscCode, errorElement, currentLanguage === 'Hindi' ? 'कृपया एक वैध IFSC कोड दर्ज करें' : 'Please enter a valid IFSC code');
                    return false;
                }
                
                showSuccess(elements.ifscCode, errorElement);
                return true;
            }
            
            function validateCaptcha() {
                const enteredCaptcha = elements.captchaInput.value.trim();
                const errorElement = document.getElementById('captchaError');
                
                if (!enteredCaptcha) {
                    showError(elements.captchaInput, errorElement, currentLanguage === 'Hindi' ? 'कृपया CAPTCHA कोड दर्ज करें' : 'Please enter the CAPTCHA code');
                    return false;
                }
                
                if (enteredCaptcha !== currentCaptcha) {
                    showError(elements.captchaInput, errorElement, currentLanguage === 'Hindi' ? 'गलत CAPTCHA कोड। कृपया पुनः प्रयास करें।' : 'Incorrect CAPTCHA code. Please try again.');
                    return false;
                }
                
                hideError(elements.captchaInput, errorElement);
                return true;
            }
            
            function validateTerms() {
                if (!elements.termsAgree.checked) {
                    return false;
                }
                return true;
            }
            
            function validateAllFields() {
                const validations = [
                    validateFullName(),
                    validatePhone(),
                    validateEmail(),
                    validatePassword(),
                    validateConfirmPassword(),
                    validateCaptcha(),
                    validateTerms()
                ];
                
                return validations.every(validation => validation === true);
            }
            
            // ==============================================
            // 6. HELPER FUNCTIONS
            // ==============================================
            function showError(input, errorElement, message) {
                if (input) input.classList.add('input-error');
                if (input) input.classList.remove('input-success');
                if (errorElement) {
                    errorElement.querySelector('span').textContent = message;
                    errorElement.style.display = 'flex';
                }
            }
            
            function showSuccess(input, errorElement) {
                if (input) input.classList.remove('input-error');
                if (input) input.classList.add('input-success');
                if (errorElement) errorElement.style.display = 'none';
            }
            
            function hideError(input, errorElement) {
                if (input) input.classList.remove('input-error');
                if (input) input.classList.remove('input-success');
                if (errorElement) errorElement.style.display = 'none';
            }
            
            function togglePasswordVisibility(input, toggleButton) {
                if (!input || !toggleButton) return;
                
                const type = input.getAttribute('type') === 'password' ? 'text' : 'password';
                input.setAttribute('type', type);
                
                const icon = toggleButton.querySelector('i');
                if (icon) {
                    if (type === 'text') {
                        icon.classList.remove('fa-eye');
                        icon.classList.add('fa-eye-slash');
                    } else {
                        icon.classList.remove('fa-eye-slash');
                        icon.classList.add('fa-eye');
                    }
                }
            }
            
            function updatePasswordStrength() {
                if (!elements.registerPassword || !elements.passwordStrengthBar || !elements.strengthText || !elements.passwordStrengthText) return;
                
                const password = elements.registerPassword.value;
                let strength = 0;
                let strengthTextValue = 'Weak';
                let strengthColor = '#e74c3c';
                
                if (password.length >= 8) strength += 25;
                if (/[a-z]/.test(password)) strength += 25;
                if (/[A-Z]/.test(password)) strength += 25;
                if (/[0-9]/.test(password) && /[@$!%*?&]/.test(password)) strength += 25;
                
                elements.passwordStrengthBar.style.width = `${strength}%`;
                
                if (strength >= 75) {
                    strengthTextValue = 'Strong';
                    strengthColor = '#2ecc71';
                } else if (strength >= 50) {
                    strengthTextValue = 'Medium';
                    strengthColor = '#f39c12';
                }
                
                elements.passwordStrengthBar.style.backgroundColor = strengthColor;
                elements.strengthText.textContent = strengthTextValue;
                elements.passwordStrengthText.style.display = 'block';
                elements.passwordStrengthText.style.color = strengthColor;
            }
            
            function generateCaptcha() {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
                let captcha = '';
                for (let i = 0; i < 6; i++) {
                    captcha += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                
                currentCaptcha = captcha;
                if (elements.captchaText) {
                    elements.captchaText.textContent = captcha;
                }
                
                if (elements.captchaInput) {
                    elements.captchaInput.value = '';
                    hideError(elements.captchaInput, document.getElementById('captchaError'));
                }
            }
            
            function showErrorAlert(message) {
                if (elements.errorAlert) {
                    document.getElementById('errorAlertText').textContent = message;
                    elements.errorAlert.style.display = 'flex';
                    
                    // Hide after 5 seconds
                    setTimeout(() => {
                        elements.errorAlert.style.display = 'none';
                    }, 5000);
                }
            }
            
            function showLoading(show) {
                if (elements.registerButton) {
                    elements.registerButton.disabled = show;
                }
                if (elements.registerLoader) {
                    elements.registerLoader.style.display = show ? 'inline-block' : 'none';
                }
                if (elements.registerText) {
                    elements.registerText.textContent = show ? 
                        (currentLanguage === 'Hindi' ? 'खाता बनाया जा रहा है...' : 'Creating Account...') : 
                        (currentLanguage === 'Hindi' ? 'खाता बनाएं' : 'Create Account');
                }
            }
            
            // ==============================================
            // 7. SPEECH SUPPORT FUNCTIONS
            // ==============================================
            function setupSpeechSupport() {
                if (!window.speechSynthesis) {
                    console.warn("Speech synthesis not supported");
                    return;
                }
                
                const inputs = [
                    elements.fullName, elements.phoneNumber, elements.registerEmail,
                    elements.registerPassword, elements.confirmPassword, elements.accountHolderName,
                    elements.accountNumber, elements.ifscCode, elements.captchaInput
                ];
                
                inputs.forEach(input => {
                    if (input) {
                        input.addEventListener('focus', function() {
                            if (speechEnabled) {
                                speakFieldInstruction(this.id);
                                this.parentElement.classList.add('speaking');
                                setTimeout(() => {
                                    this.parentElement.classList.remove('speaking');
                                }, 2000);
                            }
                        });
                    }
                });
            }
            
            function speakFieldInstruction(fieldId) {
                if (!speechEnabled || !window.speechSynthesis) return;
                
                const instructions = {
                    'fullName': 'अपना पूरा नाम दर्ज करें',
                    'phoneNumber': 'अपना फोन नंबर दर्ज करें',
                    'registerEmail': 'अपना ईमेल दर्ज करें',
                    'registerPassword': 'अपना पासवर्ड दर्ज करें',
                    'confirmPassword': 'अपने पासवर्ड की पुष्टि करें',
                    'accountHolderName': 'खाता धारक का नाम दर्ज करें',
                    'accountNumber': 'खाता संख्या दर्ज करें',
                    'ifscCode': 'आईएफएससी कोड दर्ज करें',
                    'captchaInput': 'कैप्चा कोड दर्ज करें'
                };
                
                const instruction = instructions[fieldId];
                if (instruction) {
                    const msg = new SpeechSynthesisUtterance(instruction);
                    msg.lang = 'hi-IN';
                    window.speechSynthesis.speak(msg);
                }
            }
            
            // ==============================================
            // 8. FORM SUBMISSION HANDLER
            // ==============================================
            async function handleFormSubmit(e) {
                e.preventDefault();
                console.log("Form submission started");
                
                // Validate all fields
                if (!validateAllFields()) {
                    showErrorAlert(currentLanguage === 'Hindi' ? 
                        'कृपया फॉर्म में त्रुटियों को ठीक करें' : 
                        'Please fix the errors in the form');
                    return;
                }
                
                // Show loading state
                showLoading(true);
                
                try {
                    // Collect form data
                    const formData = {
                        fullName: elements.fullName.value.trim(),
                        phone: elements.phoneNumber.value.trim().replace(/\D/g, ''),
                        email: elements.registerEmail.value.trim(),
                        password: elements.registerPassword.value,
                        language: currentLanguage,
                        accountHolderName: elements.accountHolderName.value.trim(),
                        accountNumber: elements.accountNumber.value.trim(),
                        ifscCode: elements.ifscCode.value.trim().toUpperCase(),
                        timestamp: new Date().toISOString()
                    };
                    
                    console.log("Form data collected:", { ...formData, password: '***' });
                    
                    // Simulate API call (replace with actual API call)
                    await simulateRegistrationAPI(formData);
                    
                    // Show success
                    if (elements.successMessage) {
                        elements.successMessage.style.display = 'flex';
                    }
                    if (elements.registerForm) {
                        elements.registerForm.style.display = 'none';
                    }
                    
                    // Speak success message if Hindi
                    if (speechEnabled && window.speechSynthesis) {
                        const msg = new SpeechSynthesisUtterance('पंजीकरण सफल! लॉगिन पर रीडायरेक्ट किया जा रहा है');
                        msg.lang = 'hi-IN';
                        window.speechSynthesis.speak(msg);
                    }
                    
                    // Redirect to login after 3 seconds
                    setTimeout(() => {
                        window.location.href = 'login.html';
                    }, 3000);
                    
                } catch (error) {
                    console.error("Registration error:", error);
                    showErrorAlert(currentLanguage === 'Hindi' ? 
                        'पंजीकरण में त्रुटि: ' + error.message : 
                        'Registration error: ' + error.message);
                    
                    // Generate new CAPTCHA on error
                    generateCaptcha();
                    
                    // Reset loading state
                    showLoading(false);
                }
            }
            
            // ==============================================
            // 9. SIMULATED API FUNCTION
            // ==============================================
            async function simulateRegistrationAPI(formData) {
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        // Simulate validation
                        if (!formData.email || !formData.password) {
                            reject(new Error(currentLanguage === 'Hindi' ? 'ईमेल और पासवर्ड आवश्यक हैं' : 'Email and password are required'));
                            return;
                        }
                        
                        // Simulate success
                        console.log("Registration successful for:", formData.email);
                        
                        // Store user data in localStorage for demo
                        const userData = {
                            id: 'user_' + Date.now(),
                            ...formData,
                            registeredAt: new Date().toISOString()
                        };
                        
                        // Save to localStorage
                        const users = JSON.parse(localStorage.getItem('growsmart_users') || '[]');
                        users.push(userData);
                        localStorage.setItem('growsmart_users', JSON.stringify(users));
                        
                        // Also save current user session
                        localStorage.setItem('growsmart_current_user', JSON.stringify({
                            email: formData.email,
                            name: formData.fullName,
                            language: formData.language,
                            loggedIn: true
                        }));
                        
                        resolve(userData);
                    }, 1500); // Simulate network delay
                });
            }
            
            // ==============================================
            // 10. INITIALIZE THE PAGE
            // ==============================================
            initializePage();
        });
    </script>
</body>
</html>
