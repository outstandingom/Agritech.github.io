<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GrowSmart - Plant Stage Identification</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        :root {
            --primary: #2E8B57;
            --primary-light: #3CB371;
            --primary-dark: #228B22;
            --warning: #FF6347;
            --error: #DC143C;
            --background: #F5F5F5;
            --surface: #FFFFFF;
            --text: #2F4F4F;
            --text-light: #708090;
            --border: #E0E0E0;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --radius: 16px;
        }

        body {
            background-color: var(--background);
            color: var(--text);
            line-height: 1.6;
            padding: 16px;
            max-width: 100%;
            margin: 0 auto;
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
        }

        .app-title {
            font-size: 28px;
            font-weight: 800;
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .content-card {
            background: var(--surface);
            border-radius: var(--radius);
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text);
            text-align: center;
        }

        .upload-area {
            border: 2px dashed var(--border);
            border-radius: var(--radius);
            padding: 40px 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
            text-align: center;
        }

        .upload-area:hover {
            border-color: var(--primary);
            background: rgba(46, 139, 87, 0.05);
        }

        .upload-icon {
            font-size: 64px;
            color: var(--primary-light);
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 18px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .upload-subtext {
            font-size: 14px;
            color: var(--text-light);
            margin-bottom: 20px;
        }

        .upload-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .upload-btn:hover {
            background: var(--primary-dark);
        }

        #fileInput {
            display: none;
        }

        .image-preview {
            display: none;
            margin-top: 20px;
            text-align: center;
        }

        .preview-image {
            max-width: 100%;
            max-height: 300px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }

        .preview-actions {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 12px 24px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
        }

        .analyze-btn {
            background: var(--primary);
            color: white;
        }

        .analyze-btn:hover {
            background: var(--primary-dark);
        }

        .remove-btn {
            background: var(--warning);
            color: white;
        }

        .ai-processing {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .processing-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(46, 139, 87, 0.2);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .analysis-results {
            display: none;
            margin-top: 20px;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-card {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--primary);
        }

        .stage-result {
            background: rgba(46, 139, 87, 0.1);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            margin: 20px 0;
        }

        .stage-emoji {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .stage-name {
            font-size: 22px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .stage-description {
            font-size: 16px;
            color: var(--text);
            line-height: 1.6;
        }

        .error-display {
            background: rgba(220, 20, 60, 0.1);
            border: 1px solid var(--error);
            border-radius: var(--radius);
            padding: 15px;
            margin: 15px 0;
            display: none;
            text-align: center;
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }

        .demo-mode {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: var(--radius);
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="app-title">
                <i class="fas fa-seedling"></i>
                Plant Stage Identifier
            </div>
        </div>

        <!-- Upload Section -->
        <div class="content-card">
            <div class="section-title">
                Upload Crop Photo
            </div>
            
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">
                    <i class="fas fa-camera"></i>
                </div>
                <div class="upload-text">Take or upload a photo of your crop</div>
                <div class="upload-subtext">We'll identify the growth stage using AI</div>
                <button class="upload-btn" id="uploadButton">
                    <i class="fas fa-folder-open"></i>
                    Choose Image
                </button>
                <input type="file" id="fileInput" accept="image/*">
            </div>
            
            <div class="image-preview" id="imagePreview">
                <img src="" alt="Crop Preview" class="preview-image" id="previewImage">
                <div class="preview-actions">
                    <button class="action-btn analyze-btn" id="analyzeButton">
                        <i class="fas fa-search"></i>
                        Identify Plant Stage
                    </button>
                    <button class="action-btn remove-btn" id="removeImageButton">
                        <i class="fas fa-times"></i>
                        Remove Image
                    </button>
                </div>
            </div>
        </div>

        <!-- Demo Mode Notice -->
        <div class="demo-mode" id="demoMode">
            <i class="fas fa-info-circle"></i>
            Currently in demo mode. The AI will analyze your image and provide plant stage identification.
        </div>

        <!-- AI Processing -->
        <div class="ai-processing" id="aiProcessing">
            <div class="processing-spinner"></div>
            <div style="font-size: 18px; font-weight: 600; margin-bottom: 10px;">Analyzing Your Plant Image</div>
            <div style="color: var(--text-light);">Identifying growth stage with AI...</div>
        </div>

        <!-- Error Display -->
        <div class="error-display" id="errorDisplay">
            <i class="fas fa-exclamation-triangle"></i>
            <span id="errorMessage">An error occurred while processing your request.</span>
        </div>

        <!-- Analysis Results -->
        <div class="analysis-results" id="analysisResults">
            <div class="section-title">
                Analysis Results
            </div>
            
            <div class="result-card">
                <div style="text-align: center; margin-bottom: 20px; font-size: 18px; color: var(--primary);">
                    <i class="fas fa-robot"></i> AI Analysis Complete
                </div>
                
                <div class="stage-result" id="stageResult">
                    <!-- Results will be shown here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const fileInput = document.getElementById('fileInput');
        const uploadArea = document.getElementById('uploadArea');
        const uploadButton = document.getElementById('uploadButton');
        const imagePreview = document.getElementById('imagePreview');
        const previewImage = document.getElementById('previewImage');
        const analyzeButton = document.getElementById('analyzeButton');
        const removeImageButton = document.getElementById('removeImageButton');
        const aiProcessing = document.getElementById('aiProcessing');
        const analysisResults = document.getElementById('analysisResults');
        const stageResult = document.getElementById('stageResult');
        const errorDisplay = document.getElementById('errorDisplay');
        const errorMessage = document.getElementById('errorMessage');
        const demoMode = document.getElementById('demoMode');

        // Plant stages configuration
        const plantStages = {
            germination: {
                emoji: "ðŸŒ±",
                name: "Germination Stage",
                description: "Seeds are sprouting with initial root and shoot development. This is the beginning of plant growth."
            },
            seedling: {
                emoji: "ðŸŒ¿",
                name: "Seedling Stage",
                description: "Young plants with first true leaves developing. The plant is establishing its root system."
            },
            vegetative: {
                emoji: "ðŸŒ¿",
                name: "Vegetative Stage",
                description: "Active growth with multiple leaves and strong stem development. Plant is building energy for reproduction."
            },
            flowering: {
                emoji: "ðŸŒ¸",
                name: "Flowering Stage",
                description: "Flowers or reproductive structures are visible. Pollination occurs during this stage."
            },
            fruiting: {
                emoji: "ðŸ…",
                name: "Fruiting Stage",
                description: "Fruits or grains are developing and growing in size. Plant is directing energy to fruit production."
            },
            maturity: {
                emoji: "ðŸŒ»",
                name: "Maturity Stage",
                description: "Plant has reached full growth. Fruits are ripe and ready for harvest."
            }
        };

        // Error Handling
        function showError(message) {
            errorMessage.textContent = message;
            errorDisplay.style.display = 'block';
        }

        function hideError() {
            errorDisplay.style.display = 'none';
        }

        // Handle file selection
        function handleFileSelect() {
            if (fileInput.files && fileInput.files[0]) {
                const file = fileInput.files[0];
                
                if (!file.type.match('image.*')) {
                    showError('Please select an image file (JPG, PNG, WebP).');
                    return;
                }
                
                if (file.size > 5 * 1024 * 1024) {
                    showError('File size exceeds 5MB limit. Please choose a smaller image.');
                    return;
                }
                
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    previewImage.src = e.target.result;
                    imagePreview.style.display = 'block';
                    analysisResults.style.display = 'none';
                    hideError();
                };
                
                reader.readAsDataURL(file);
            }
        }

        // Remove image
        function removeImage() {
            fileInput.value = '';
            imagePreview.style.display = 'none';
            analysisResults.style.display = 'none';
            hideError();
        }

        // Simulate AI analysis with realistic responses
        function simulateAIResponse(imageData) {
            // This simulates what Gemini AI would return
            const stages = Object.keys(plantStages);
            const randomStage = stages[Math.floor(Math.random() * stages.length)];
            const stage = plantStages[randomStage];
            
            // Add some realistic variations based on the stage
            const descriptions = {
                germination: [
                    "I can see seeds sprouting with small roots and shoots emerging from the soil.",
                    "The germination process is underway with visible seedling emergence.",
                    "Early growth stage with cotyledons (seed leaves) visible above soil."
                ],
                seedling: [
                    "Young seedlings with first true leaves developing alongside cotyledons.",
                    "The plant is establishing its root system with delicate young leaves.",
                    "Early vegetative growth with proper leaf formation beginning."
                ],
                vegetative: [
                    "Healthy vegetative growth with multiple sets of true leaves visible.",
                    "Strong stem development and active leaf production observed.",
                    "Plant is in active growth phase with good foliage development."
                ],
                flowering: [
                    "Flower buds or open flowers visible, indicating reproductive stage.",
                    "The plant has entered flowering phase with visible reproductive structures.",
                    "Bloom development observed with flower formation."
                ],
                fruiting: [
                    "Fruit development visible with young fruits forming on the plant.",
                    "The plant is in fruiting stage with developing produce.",
                    "Fruit set observed with visible fruit growth."
                ],
                maturity: [
                    "Plant has reached maturity with fully developed fruits/grains.",
                    "Harvest-ready stage with ripe produce visible.",
                    "Complete growth cycle with mature plant structure."
                ]
            };
            
            const randomDesc = descriptions[randomStage][Math.floor(Math.random() * descriptions[randomStage].length)];
            
            return {
                stage: randomStage,
                confidence: "High",
                description: randomDesc,
                recommendations: [
                    "Continue current care practices",
                    "Monitor plant health regularly",
                    "Adjust watering based on weather conditions"
                ]
            };
        }

        // Analyze plant with simulated AI
        async function analyzePlant() {
            if (!fileInput.files || !fileInput.files[0]) {
                showError('Please select an image first.');
                return;
            }
            
            // Show processing state
            analyzeButton.innerHTML = '<span class="spinner"></span> Analyzing...';
            analyzeButton.disabled = true;
            aiProcessing.style.display = 'block';
            analysisResults.style.display = 'none';
            hideError();

            try {
                // Simulate API call delay
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Convert image to base64 for simulation
                const base64Image = await new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const base64 = e.target.result.split(',')[1];
                        resolve(base64);
                    };
                    reader.readAsDataURL(fileInput.files[0]);
                });

                // Get simulated AI response
                const analysisResult = simulateAIResponse(base64Image);
                
                // Display results
                displayAnalysisResults(analysisResult);
                
            } catch (error) {
                console.error('Analysis Error:', error);
                showError('Failed to analyze the image. Please try again.');
            } finally {
                analyzeButton.innerHTML = '<i class="fas fa-search"></i> Identify Plant Stage';
                analyzeButton.disabled = false;
                aiProcessing.style.display = 'none';
            }
        }

        // Display analysis results
        function displayAnalysisResults(result) {
            const stage = plantStages[result.stage];
            
            stageResult.innerHTML = `
                <div class="stage-emoji">${stage.emoji}</div>
                <div class="stage-name">${stage.name}</div>
                <div class="stage-description">
                    <strong>AI Analysis:</strong> ${result.description}<br><br>
                    <strong>Confidence:</strong> ${result.confidence}<br><br>
                    <strong>Recommendations:</strong><br>
                    ${result.recommendations.map(rec => `â€¢ ${rec}`).join('<br>')}
                </div>
            `;
            
            analysisResults.style.display = 'block';
        }

        // Event Listeners
        function setupEventListeners() {
            // File upload
            uploadButton.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', handleFileSelect);
            
            // Drag and drop
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = 'var(--primary)';
                uploadArea.style.background = 'rgba(46, 139, 87, 0.1)';
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.style.borderColor = 'var(--border)';
                uploadArea.style.background = 'transparent';
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = 'var(--border)';
                uploadArea.style.background = 'transparent';
                
                if (e.dataTransfer.files.length) {
                    fileInput.files = e.dataTransfer.files;
                    handleFileSelect();
                }
            });
            
            // Analysis buttons
            analyzeButton.addEventListener('click', analyzePlant);
            removeImageButton.addEventListener('click', removeImage);

            // Error display close
            errorDisplay.addEventListener('click', hideError);
        }

        // Initialize the application
        function initApp() {
            setupEventListeners();
            console.log('Plant Stage Identifier initialized');
        }

        // Start the application
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
